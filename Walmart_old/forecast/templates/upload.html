<!doctype html>
<html lang="en">

<head>
    {% load static %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="icon" sizes="192x192" href="{% static 'images/favicon.ico'%}">
    <title>WFM Dashboard</title>
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no" />
    <meta name="description" content="This is an example dashboard created using build-in elements and components.">
    <meta name="msapplication-tap-highlight" content="no">
    <link href="{% static 'css/main.css' %} " rel="stylesheet">
    <style>
        .progress {
            height: 6px;
        }

        .widget-numbers {
            font-size: 22px !important;
        }
    </style>
</head>

<body>
    <div class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header closed-sidebar">
        <div class="app-header header-shadow">
            <div class="app-header__logo">
                <div class="logo-src"></div>
                <div class="header__pane ml-auto">
                    <div>
                        <button type="button" class="hamburger close-sidebar-btn hamburger--elastic"
                            data-class="closed-sidebar">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="app-header__mobile-menu">
                <div>
                    <button type="button" class="hamburger hamburger--elastic mobile-toggle-nav">
                        <span class="hamburger-box">
                            <span class="hamburger-inner"></span>
                        </span>
                    </button>
                </div>
            </div>
            <div class="app-header__menu">
                <span>
                    <button type="button"
                        class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav">
                        <span class="btn-icon-wrapper">
                            <i class="fa fa-ellipsis-v fa-w-6"></i>
                        </span>
                    </button>
                </span>
            </div>
            <div class="app-header__content">
                <div class="app-header-left">
                    <!--  <div class="search-wrapper">
                        <div class="input-holder">
                            <input type="text" class="search-input" placeholder="Type to search">
                            <button class="search-icon"><span></span></button>
                        </div>
                        <button class="close"></button>
                    </div>
                    <ul class="header-menu nav">
                        <li class="nav-item">
                            <a href="javascript:void(0);" class="nav-link">
                                <i class="nav-link-icon fa fa-database"> </i>
                                Statistics
                            </a>
                        </li>
                        <li class="btn-group nav-item">
                            <a href="javascript:void(0);" class="nav-link">
                                <i class="nav-link-icon fa fa-edit"></i>
                                Projects
                            </a>
                        </li>
                        <li class="dropdown nav-item">
                            <a href="javascript:void(0);" class="nav-link">
                                <i class="nav-link-icon fa fa-cog"></i>
                                Settings
                            </a>
                        </li>
                    </ul> -->
                </div>
                <div class="app-header-right">
                    <div class="header-btn-lg pr-0">
                        <div class="widget-content p-0">
                            <div class="widget-content-wrapper">
                                <div class="widget-content-left">
                                    <div class="btn-group">
                                        <a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                                            class="p-0 btn">
                                            <img width="42" class="rounded-circle" src="{% static 'images/avatars/13.png' %}"
                                                alt="">
                                            <i class="fa fa-angle-down ml-2 opacity-8"></i>
                                        </a>
                                        <div tabindex="-1" role="menu" aria-hidden="true"
                                            class="dropdown-menu dropdown-menu-right">
                                            <button type="button" tabindex="0" class="dropdown-item">{{username | title}}</button>
                                            <a href="{% url 'rpass' %}" style="text-decoration: none;"><button type="button" tabindex="0" class="dropdown-item">Change Password</button></a>
                                            <div tabindex="-1" class="dropdown-divider"></div>
                                            <a href="{% url 'logoutUser' %}" style="text-decoration: none;"><button type="button" tabindex="0" class="dropdown-item">Logout</button></a>
                                        </div>
                                    </div>
                                </div>
                                <!-- <div class="widget-content-left  ml-3 header-user-info">
                                    <div class="widget-heading">
                                        Palaniyappan S
                                    </div>
                                    <div class="widget-subheading">
                                        Manager
                                    </div>
                                </div> -->
                                <!-- <div class="widget-content-right header-user-info ml-3">
                                    <button type="button"
                                        class="btn-shadow p-1 btn btn-primary btn-sm show-toastr-example">
                                        <i class="fa text-white fa-calendar pr-1 pl-1"></i>
                                    </button>
                                </div> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="app-main">
            <div class="app-sidebar sidebar-shadow">
                <div class="app-header__logo">
                    <div class="logo-src"></div>
                    <div class="header__pane ml-auto">
                        <div>
                            <button type="button" class="hamburger close-sidebar-btn hamburger--elastic"
                                data-class="closed-sidebar">
                                <span class="hamburger-box">
                                    <span class="hamburger-inner"></span>
                                </span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="app-header__mobile-menu">
                    <div>
                        <button type="button" class="hamburger hamburger--elastic mobile-toggle-nav">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
                        </button>
                    </div>
                </div>
                <div class="app-header__menu">
                    <span>
                        <button type="button"
                            class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav">
                            <span class="btn-icon-wrapper">
                                <i class="fa fa-ellipsis-v fa-w-6"></i>
                            </span>
                        </button>
                    </span>
                </div>
                <div class="scrollbar-sidebar">
                    <div class="app-sidebar__inner">
                        <ul class="vertical-nav-menu">
                            <li class="app-sidebar__heading">Menu</li>
                            <!-- <li>
                                <a href="/wfm/dashboard/">
                                    <i class="metismenu-icon pe-7s-rocket"></i>
                                    Dashboard
                                </a>
                            </li> -->
                            <li>
                                <a href="/wfm/upload/" class="mm-active">
                                    <i class="metismenu-icon pe-7s-upload">
                                    </i>Uploads
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="app-main__outer">
                <div class="app-main__inner">
                    <div class="app-page-title py-3 mb-3">
                        <div class="page-title-wrapper">
                            <div class="page-title-heading">
                                <div class="page-title-icon">
                                    <i class="pe-7s-upload icon-gradient bg-mean-fruit">
                                    </i>
                                </div>
                                <div><span id="page-title">Forecast Application</span>
                                    <div class="page-title-subheading">
                                        <nav aria-label="breadcrumb">
                                            <ol class="breadcrumb" id="wfm-breadcrumbs">
                                            </ol>
                                        </nav>
                                    </div>

                                </div>
                            </div>
                            <!-- <div class="page-title-actions">
                                <div class="d-inline-block main-btns">
                                    <a class="mb-2 mr-2 btn-transition btn btn-outline-secondary" data-toggle="modal"
                                        data-target="#exampleModalLong"><i class="fa fa-map-marker fa-w-20"
                                            aria-hidden="true"></i> Geo</a>
                                    <a href="LOB.html" class="mb-2 mr-2 btn-transition btn btn-outline-secondary"><i
                                            class="fa fa-info-circle fa-w-20"></i> LOB</a>
                                    <a class="mb-2 mr-2 btn-transition btn btn-outline-secondary"><i
                                            class="fa fa-cubes fa-w-20"></i> Channels</a>
                                    <div class="d-inline-block">
                                        <a class="mb-2 mr-2 btn-transition btn dropdown-toggle btn-outline-secondary"
                                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i
                                                class="fa fa-users fa-w-20" aria-hidden="true"></i> <span
                                                class="wfm-partner">Partners</span></a>
                                        <div class="dropdown-menu">
                                            <ul class="nav flex-column" id="partner-dropdown">
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-block dropdown text-lg-right">
                                    <button type="button" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false"
                                        class="mb-0 mr-2 p-0 dropdown-toggle btn btn-outline-link">
                                        <span class="btn-icon-wrapper pr-2 opacity-7">
                                            <i class="fa fa-calendar-alt fa-w-20"></i>
                                        </span>
                                        <span class="wfm-date">Date</span>
                                    </button>
                                    <div class="dropdown-menu">
                                        <ul class="nav flex-column">
                                            <li class="nav-item">
                                                <a href="javascript:void(0);"
                                                    onclick="sessionStorage.setItem('wfm-date', 'current_week');initilize_data();"
                                                    class="nav-link">
                                                    <i class="nav-link-icon lnr-inbox fa fa-circle"></i>
                                                    <span>
                                                        Current Week
                                                    </span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="javascript:void(0);"
                                                    onclick="sessionStorage.setItem('wfm-date', 'last_week');initilize_data();"
                                                    class="nav-link">
                                                    <i class="nav-link-icon lnr-picture fa fa-circle"></i>
                                                    <span>
                                                        Last Week
                                                    </span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="javascript:void(0);"
                                                    onclick="sessionStorage.setItem('wfm-date', 'last_two_week');initilize_data();"
                                                    class="nav-link">
                                                    <i class="nav-link-icon lnr-picture fa fa-circle"></i>
                                                    <span>
                                                        Last Two Weeks
                                                    </span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="javascript:void(0);"
                                                    onclick="sessionStorage.setItem('wfm-date', 'last_three_week');initilize_data();"
                                                    class="nav-link">
                                                    <i class="nav-link-icon lnr-picture fa fa-circle"></i>
                                                    <span>
                                                        Last Three Weeks
                                                    </span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="javascript:void(0);"
                                                    onclick="sessionStorage.setItem('wfm-date', 'current_month');initilize_data();"
                                                    class="nav-link">
                                                    <i class="nav-link-icon lnr-book fa fa-circle"></i>
                                                    <span>
                                                        Current Month
                                                    </span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a  href="javascript:void(0);"
                                                    onclick="sessionStorage.setItem('wfm-date', 'last_month');initilize_data();"
                                                    class="nav-link">
                                                    <i class="nav-link-icon lnr-file-empty fa fa-circle"></i>
                                                    <span>
                                                        Last Month
                                                    </span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div> -->
                        </div>
                    </div>
                    <div class="main-card mb-3 card">
                        <div class="card-body">
                            <h5 class="card-title">Upload</h5>
                            <form method="POST" enctype="multipart/form-data">
                                {% csrf_token %}
                                <div class="position-relative row form-group">
                                    <label for="exampleFile" class="col-sm-2 col-form-label">File</label>
                                    <div class="col-sm-10 col-md-6 col-lg-5">
                                        <input name="file" id="exampleFile" accept=".xls,.xlsx,.csv" type="file" class="form-control-file" onchange="$('#others select, #others button').removeAttr('disabled');" required/>
                                    </div>
                                </div>
                                <div id="others">
                                    <div class="position-relative row form-group"><label for="column"
                                            class="col-sm-2 col-form-label">Select a channel</label>
                                        <div class="col-sm-10 col-md-6 col-lg-5">
                                            <select disabled name="column" id="column" class="form-control" required>
                                                <option value="">Select a channel</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="position-relative row form-group"><label for="date"
                                            class="col-sm-2 col-form-label">Select forecast type</label>
                                        <div class="col-sm-10 col-md-6 col-lg-5">
                                            <select disabled name="date" id="date" class="form-control" required>
                                                <option value="">Select forecast type</option>
                                                <option value="Day">Day</option>
                                                <option value="Month">Month</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="position-relative row form-group"><label for="interval"
                                            class="col-sm-2 col-form-label">Forecast horizon</label>
                                        <div class="col-sm-10 col-md-6 col-lg-5">
                                            <select disabled name="interval" id="interval" class="form-control" required>
                                                <option value=''>Forecast horizon</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="position-relative row">
                                        <div class="col-sm-10 offset-sm-2">
                                            <button type="submit" disabled class="btn btn-primary" onclick="$('#loader').show();">Submit</button>
                                            <button class="btn btn-secondary">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                </div>
                <div class="app-wrapper-footer">
                    <div class="app-footer">
                        <div class="app-footer__inner">
                            <div class="app-footer-left">
                                <ul class="nav">
                                    <li class="nav-item">
                                        <!-- <a href="javascript:void(0);" class="nav-link">
                                            Footer Link 1
                                        </a> -->
                                    </li>
                                    <li class="nav-item">
                                        <!-- <a href="javascript:void(0);" class="nav-link">
                                            Footer Link 2
                                        </a> -->
                                    </li>
                                </ul>
                            </div>
                            <div class="app-footer-right">
                                <ul class="nav">
                                    <li class="nav-item">
                                        <a href="javascript:void(0);" class="nav-link">
                                            <img src="{% static 'images/logo-inverse.png' %}" alt="Walmart">
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <script src="http://maps.google.com/maps/api/js?sensor=true"></script> -->
        </div>
    </div>
     <div id="loader" style="display: none; background-color: rgba(255, 255, 255, 0.8); position: fixed; top:0;left: 0;right: 0;bottom: 0;z-index: 9999;">
        <img src="{% static 'images/loader.gif' %}" alt="loader" style="position: absolute;left: 50%;top: 50%;transform: translate(-50%, -50%);width: 200px;">
    </div>
    <!-- Geo -->

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="{% static 'scripts/main.js' %}"></script>
    <script type="text/javascript">
        $("document").ready(function(){
            $("#exampleFile").change(function() {
                file=$('#exampleFile').prop('files')[0]
                var csrf_token = "{{ csrf_token }}"
                var fd = new FormData()
                fd.append('docs', file)
                $.ajax({
                    url : '/edit_upload/',
                    csrfmiddlewaretoken : csrf_token,
                    type : 'POST',
                    data : fd,
                    contentType: false,
                    processData: false,
                    success: function(data) {
                        val=JSON.parse(data);
                        x='<option value="">Select a channel</option>'
                        for(var i=0; i<val['columns'].length; i++ )
                        {
                            if (i > 0) 
                            {
                                x +='<option value="'+val['columns'][i]+'">'+val['columns'][i]+'</option>'
                            }
                        }
                        document.getElementById("column").innerHTML=x
                        $( "#column option:first-child" ).attr("disabled","disabled");
                        $( "#date option:first-child" ).attr("disabled","disabled");
                        document.getElementById("interval").disabled = true
                    },
                    failure: function(data) { 
                        alert('Error while uploading...')
                    }
                  });
            });

            $('#date').change(function(){
                if ($('#date :selected').text() == 'Day'){
                    document.getElementById("interval").disabled = false
                    document.getElementById('interval').innerHTML="<option>Select forecast horizon</option><option>7</option><option>14</option><option>21</option><option>28</option><option>35</option><option>42</option><option>49</option><option>56</option><option>63</option><option>70</option><option>77</option><option>84</option><option>91</option><option>98</option><option>105</option><option>112</option><option>119</option><option>126</option><option>133</option><option>140</option><option>147</option><option>154</option><option>161</option><option>168</option><option>175</option><option>182</option><option>189</option><option>196</option><option>203</option><option>210</option><option>217</option><option>224</option><option>231</option><option>238</option><option>245</option><option>252</option><option>259</option><option>266</option><option>273</option><option>280</option><option>287</option><option>294</option><option>301</option><option>308</option><option>315</option><option>322</option><option>329</option><option>336</option><option>343</option><option>350</option><option>357</option><option>365</option>"
                    $( "#interval option:first-child" ).attr("disabled","disabled");
                }
                else if($('#date :selected').text() == 'Month'){
                    document.getElementById("interval").disabled = false
                    document.getElementById('interval').innerHTML="<option>Select forecast horizon</option><option>12</option><option>24</option><option>30</option><option>36</option>"
                    $( "#interval option:first-child" ).attr("disabled","disabled");
                }
            });
        });
    </script>
</body>

</html>