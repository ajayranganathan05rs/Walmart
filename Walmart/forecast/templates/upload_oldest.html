<!doctype html>
<html lang="en">

<head>
    {% load static %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>WFM Dashboard</title>
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no" />
    <meta name="description" content="This is an example dashboard created using build-in elements and components.">
    <meta name="msapplication-tap-highlight" content="no">
    <link href="{% static 'css/main.css' %} " rel="stylesheet">
    <style>
        .progress {
            height: 6px;
        }

        .widget-numbers {
            font-size: 22px !important;
        }
    </style>
</head>

<body>
    <div class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header closed-sidebar">
        <div class="app-header header-shadow">
            <div class="app-header__logo">
                <div class="logo-src"></div>
                <div class="header__pane ml-auto">
                    <div>
                        <button type="button" class="hamburger close-sidebar-btn hamburger--elastic"
                            data-class="closed-sidebar">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="app-header__mobile-menu">
                <div>
                    <button type="button" class="hamburger hamburger--elastic mobile-toggle-nav">
                        <span class="hamburger-box">
                            <span class="hamburger-inner"></span>
                        </span>
                    </button>
                </div>
            </div>
            <div class="app-header__menu">
                <span>
                    <button type="button"
                        class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav">
                        <span class="btn-icon-wrapper">
                            <i class="fa fa-ellipsis-v fa-w-6"></i>
                        </span>
                    </button>
                </span>
            </div>
            <div class="app-header__content">
                <div class="app-header-left">
                </div>
                <div class="app-header-right">
                    <div class="header-btn-lg pr-0">
                        <div class="widget-content p-0">
                            <div class="widget-content-wrapper">
                                <div class="widget-content-left">
                                    <div class="btn-group">
                                        <a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                                            class="p-0 btn">
                                            <img width="42" class="rounded-circle" src="{% static 'images/avatars/13.png' %}"
                                                alt="">
                                        </a>
                                        <div tabindex="-1" role="menu" aria-hidden="true"
                                            class="dropdown-menu dropdown-menu-right">
                                            <button type="button" tabindex="0" class="dropdown-item">{{username | title}}</button>
                                            <a href="{% url 'rpass' %}" style="text-decoration: none;"><button type="button" tabindex="0" class="dropdown-item">Change Password</button></a>
                                            <div tabindex="-1" class="dropdown-divider"></div>
                                            <a href="{% url 'logoutUser' %}" style="text-decoration: none;"><button type="button" tabindex="0" class="dropdown-item">Logout</button></a>
                                        </div>
                                    </div>
                                </div>
                                <!-- <div class="widget-content-left  ml-3 header-user-info">
                                    <div class="widget-heading">
                                        Palaniyappan S
                                    </div>
                                    <div class="widget-subheading">
                                        Manager
                                    </div>
                                </div> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="app-main">
            <div class="app-sidebar sidebar-shadow">
                <div class="app-header__logo">
                    <div class="logo-src"></div>
                    <div class="header__pane ml-auto">
                        <div>
                            <button type="button" class="hamburger close-sidebar-btn hamburger--elastic"
                                data-class="closed-sidebar">
                                <span class="hamburger-box">
                                    <span class="hamburger-inner"></span>
                                </span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="app-header__mobile-menu">
                    <div>
                        <button type="button" class="hamburger hamburger--elastic mobile-toggle-nav">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
                        </button>
                    </div>
                </div>
                <div class="app-header__menu">
                    <span>
                        <button type="button"
                            class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav">
                            <span class="btn-icon-wrapper">
                                <i class="fa fa-ellipsis-v fa-w-6"></i>
                            </span>
                        </button>
                    </span>
                </div>
                <div class="scrollbar-sidebar">
                    <div class="app-sidebar__inner">
                        <ul class="vertical-nav-menu">
                            <li class="app-sidebar__heading">Menu</li>
                            <li>
                                <a href="/wfm/upload/" class="mm-active">
                                    <i class="metismenu-icon pe-7s-upload">
                                    </i>Uploads
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="app-main__outer">
                <div class="app-main__inner">
                    <div class="app-page-title py-3 mb-3">
                        <div class="page-title-wrapper">
                            <div class="page-title-heading">
                                <div class="page-title-icon">
                                    <i class="pe-7s-upload icon-gradient bg-mean-fruit">
                                    </i>
                                </div>
                                <div><span id="page-title">Vendorwise Distribution Application</span>
                                    <div class="page-title-subheading">
                                        <nav aria-label="breadcrumb">
                                            <ol class="breadcrumb" id="wfm-breadcrumbs">
                                            </ol>
                                        </nav>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="main-card mb-3 card">
                        <div class="card-body">
                            <h5 class="card-title">Upload</h5>
                            <form method="POST" enctype="multipart/form-data">
                                {% csrf_token %}
                                <!-- <div class="position-relative row form-group"><label for="column"
                                        class="col-sm-2 col-form-label">Input Selector</label>
                                    <div class="col-sm-10 col-md-6 col-lg-5">
                                        <select class="form-control" id="dd_interval" required>
                                            <option value="" disabled selected>Choose your input</option>
                                            <option value="Email">Last 90 days Interval</option>
                                            <option value="Voice">Last 6 Week Interval</option>
                                            <option value="Voice">Forecast</option>
                                            <option value="Voice">Vendor Distribution</option>
                                        </select>
                                    </div>
                                </div> -->

                                <div class="position-relative row form-group">
                                    <label for="exampleFile" class="col-sm-2 col-form-label">Last 90 Days Day-Level Interval <span style="color:red;">*</span></label>
                                    <div class="col-sm-10 col-md-6 col-lg-5">
                                        <input name="file" id="exampleFile" accept=".xls,.xlsx,.csv" type="file" class="form-control-file" onchange="$('#week_data input').removeAttr('disabled');" required/>
                                    </div>
                                </div>
                                <div id="week_data" class="position-relative row form-group">
                                    <label for="exampleFile" class="col-sm-2 col-form-label">Last 6 Week Interval <span style="color:red;">*</span></label>
                                    <div class="col-sm-10 col-md-6 col-lg-5">
                                        <input disabled name="file1" id="exampleFile1" accept=".xls,.xlsx,.csv" type="file" class="form-control-file" onchange="$('#queue_offered input').removeAttr('disabled');" required/>
                                    </div>
                                </div>
                                <div id="queue_offered" class="position-relative row form-group">
                                    <label for="exampleFile" class="col-sm-2 col-form-label">Forecast <span style="color:red;">*</span></label>
                                    <div class="col-sm-10 col-md-6 col-lg-5">
                                        <input disabled name="file2" id="exampleFile2" accept=".xls,.xlsx,.csv" type="file" class="form-control-file" onchange="$('#vendor_dis input').removeAttr('disabled');" required/>
                                    </div>
                                </div>
                                <div id="vendor_dis" class="position-relative row form-group">
                                    <label for="exampleFile1" class="col-sm-2 col-form-label">Vendor Distribution <span style="color:red;">*</span></label>
                                    <div class="col-sm-10 col-md-6 col-lg-5">
                                        <input disabled name="file3" id="exampleFile3" accept=".xls,.xlsx,.csv" type="file" class="form-control-file" onchange="$('#others input, #others select, #others button').removeAttr('disabled');" required/>
                                    </div>
                                </div>
                                <div id="others">
                                    <div class="position-relative row form-group"><label for="column"
                                            class="col-sm-2 col-form-label">Select a channel</label>
                                        <div class="col-sm-10 col-md-6 col-lg-5">
                                            <select disabled name="column" id="column" class="form-control" required>
                                                <option value="">Select a channel</option>
                                            </select>
                                        </div>
                                    </div>
                                    <!-- <div class="position-relative row form-group"><label for="date"
                                            class="col-sm-2 col-form-label">Select forecast type <span style="color:red;">*</span></label>
                                        <div class="col-sm-10 col-md-6 col-lg-5">
                                            <select disabled name="date" id="date" class="form-control" required>
                                                <option value="">Select forecast type</option>
                                                <option value="Day">Day</option>
                                                <option value="Month">Month</option>
                                            </select>
                                        </div>
                                    </div> -->
                                    <div class="position-relative row form-group"><label for="interval"
                                            class="col-sm-2 col-form-label">Forecast horizon (in Month) <span style="color:red;">*</span></label>
                                        <div class="col-sm-10 col-md-6 col-lg-5">
                                            <select disabled name="interval" id="interval" class="form-control" required>
                                                <option value=''>Forecast horizon</option>
                                            </select>
                                            <!-- <input disabled type="number" min="0" max="365" name="interval" class="form-control" id="interval" required> -->
                                        </div>
                                    </div>

                                    <div class="position-relative row">
                                        <div class="col-sm-10 offset-sm-2">
                                            <button type="submit" disabled class="btn btn-primary" onclick="$('#loader').show();">Submit</button>
                                            <button class="btn btn-secondary">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                </div>
                <div class="app-wrapper-footer">
                    <div class="app-footer">
                        <div class="app-footer__inner">
                            <div class="app-footer-left">
                                <ul class="nav">
                                    <li class="nav-item">
                                    </li>
                                    <li class="nav-item">
                                    </li>
                                </ul>
                            </div>
                            <div class="app-footer-right">
                                <ul class="nav">
                                    <li class="nav-item">
                                        <a href="javascript:void(0);" class="nav-link">
                                            <img src="{% static 'images/logo-inverse.png' %}" alt="Walmart">
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
     <div id="loader" style="display: none; background-color: rgba(255, 255, 255, 0.8); position: fixed; top:0;left: 0;right: 0;bottom: 0;z-index: 9999;">
        <img src="{% static 'images/loader.gif' %}" alt="loader" style="position: absolute;left: 50%;top: 50%;transform: translate(-50%, -50%);width: 200px;">
    </div>
    <!-- Geo -->

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="{% static 'scripts/main.js' %}"></script>
    <script type="text/javascript">
        $("document").ready(function(){
            $("#exampleFile3").change(function() {
                file=$('#exampleFile').prop('files')[0]
                file1=$('#exampleFile1').prop('files')[0]
                file2=$('#exampleFile2').prop('files')[0]
                file3=$('#exampleFile3').prop('files')[0]
                var csrf_token = "{{ csrf_token }}"
                var fd = new FormData()
                fd.append('docs', file)
                fd.append('docs1', file1)
                fd.append('docs2', file2)
                fd.append('docs3', file3)
                $.ajax({
                    url : '/edit_upload/',
                    csrfmiddlewaretoken : csrf_token,
                    type : 'POST',
                    data : fd,
                    contentType: false,
                    processData: false,
                    success: function(data) {
                        val=JSON.parse(data);
                        if(val['Length'] < 1){
                            alert('Kindly upload file has no rows. The current uploaded file has only '+val['Length']+' rows.')
                            window.location.reload()
                        }
                        else{
                            x='<option value="">Select a channel</option>'
                            for(var i=0; i<val['columns'].length; i++ )
                            {
                                if (i > 0) 
                                {
                                    x +='<option value="'+val['columns'][i]+'">'+val['columns'][i]+'</option>'
                                }
                            }
                            // document.getElementById("column").innerHTML=x
                            $( "#column option:first-child" ).attr("disabled","disabled");
                            // $( "#interval option:first-child" ).attr("disabled","disabled");
                            document.getElementById("interval").disabled = true;
                        }
                    },
                    failure: function(data) { 
                        alert('Error while uploading...')
                    }
                  });
            });

            $("#exampleFile").change(function() {
                file=$('#exampleFile').prop('files')[0]
                var csrf_token = "{{ csrf_token }}"
                var fd = new FormData()
                fd.append('docs', file)
                $.ajax({
                    url : '/edit_upload_1/',
                    csrfmiddlewaretoken : csrf_token,
                    type : 'POST',
                    data : fd,
                    contentType: false,
                    processData: false,
                    success: function(data) {
                        val=JSON.parse(data);
                        if(val['Length'] < 1){
                            alert('Kindly upload file has no rows. The current uploaded file has only '+val['Length']+' rows.')
                            window.location.reload()
                        }
                        else{
                            x='<option value="">Select a channel</option>'
                            for(var i=0; i<val['columns'].length; i++ )
                            {
                                if (i > 0) 
                                {
                                    x +='<option value="'+val['columns'][i]+'">'+val['columns'][i]+'</option>'
                                }
                            }
                            document.getElementById("column").innerHTML=x
                            // $( "#column option:first-child" ).attr("disabled","disabled");
                            // // $( "#interval option:first-child" ).attr("disabled","disabled");
                            // document.getElementById("interval").disabled = true;
                        }
                    },
                    failure: function(data) { 
                        alert('Error while uploading...')
                    }
                  });
            });

            $('#column').change(function(){
                document.getElementById("interval").disabled = false;
                document.getElementById('interval').innerHTML="<option value=''>Forecast horizon</option><option value='2'>2</option><option value='3'>3</option><option value='4'>4</option>"
                $( "#interval option:first-child" ).attr("disabled","disabled");
            });

        });
    </script>
</body>

</html>